# Requirements: client-runtime-validation

## 背景

- クライアント側 (`src/client/main.ts`) では `JSON.parse` 後に型アサーションしており、受信メッセージの実行時検証が不足している。
- 不正payloadや将来の互換不整合時に、クラッシュや不正状態の原因になりうる。

## 要求

1. サーバー受信メッセージに対して runtime validation を導入する。
2. 不正メッセージは処理せず破棄し、ログに記録する。
   - ただし `state.events` の未知イベントは前方互換のためイベント単位で破棄可能とする。
   - `state.events` の既知イベント破損は `state` 全体を破棄する。
3. 正常メッセージの既存挙動（描画・HUD・ロビー・観戦）を維持する。
4. ドキュメント (`docs/server_protocol.md`) に不正メッセージ時の扱いを追記する。

## 非要求

- サーバー側プロトコル仕様変更はこの対応では行わない。
- UIデザインやゲームバランス調整は対象外。
